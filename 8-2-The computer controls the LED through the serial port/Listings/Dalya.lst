C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE DALYA
OBJECT MODULE PLACED IN .\Objects\Dalya.obj
COMPILER INVOKED BY: D:\RJ\Keil5\C51\BIN\C51.EXE Dalya.c OPTIMIZE(8,SPEED) BROWSE INCDIR(D:\RJ\Keil5\C51\INC;D:\RJ\Keil5
                    -\C51\INC\Atmel) DEBUG OBJECTEXTEND PRINT(.\Listings\Dalya.lst) TABS(2) OBJECT(.\Objects\Dalya.obj)

line level    source

   1          #include "Delay.h"
   2          
   3          // å¼•è„šé…ç½®ï¼š
   4          sbit LCD_RS = P2 ^ 6;
   5          sbit LCD_RW = P2 ^ 5;
   6          sbit LCD_EN = P2 ^ 7;
   7          #define LCD_DataPort P0
   8          
   9          // å‡½æ•°å®šä¹‰ï¼š
  10          /**
  11           * @brief  LCD1602å»¶æ—¶å‡½æ•°ï¼Œ12MHzè°ƒç”¨å¯å»¶æ—¶1ms
  12           * @param  æ— 
  13           * @retval æ— 
  14           */
  15          void LCD_Delay()
  16          {
  17   1        unsigned char i, j;
  18   1      
  19   1        i = 2;
  20   1        j = 239;
  21   1        do
  22   1        {
  23   2          while (--j)
  24   2            ;
  25   2        } while (--i);
  26   1      }
  27          
  28          /**
  29           * @brief  LCD1602å†™å‘½ä»¤
  30           * @param  Command è¦å†™å…¥çš„å‘½ä»¤
  31           * @retval æ— 
  32           */
  33          void LCD_WriteCommand(unsigned char Command)
  34          {
  35   1        LCD_RS = 0;
  36   1        LCD_RW = 0;
  37   1        LCD_DataPort = Command;
  38   1        LCD_EN = 1;
  39   1        LCD_Delay();
  40   1        LCD_EN = 0;
  41   1        LCD_Delay();
  42   1      }
  43          
  44          /**
  45           * @brief  LCD1602å†™æ•°æ®
  46           * @param  Data è¦å†™å…¥çš„æ•°æ®
  47           * @retval æ— 
  48           */
  49          void LCD_WriteData(unsigned char Data)
  50          {
  51   1        LCD_RS = 1;
  52   1        LCD_RW = 0;
  53   1        LCD_DataPort = Data;
  54   1        LCD_EN = 1;
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 2   

  55   1        LCD_Delay();
  56   1        LCD_EN = 0;
  57   1        LCD_Delay();
  58   1      }
  59          
  60          /**
  61           * @brief  LCD1602è®¾ç½®å…‰æ ‡ä½ç½®
  62           * @param  Line è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
  63           * @param  Column åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
  64           * @retval æ— 
  65           */
  66          void LCD_SetCursor(unsigned char Line, unsigned char Column)
  67          {
  68   1        if (Line == 1)
  69   1        {
  70   2          LCD_WriteCommand(0x80 | (Column - 1));
  71   2        }
  72   1        else if (Line == 2)
  73   1        {
  74   2          LCD_WriteCommand(0x80 | (Column - 1 + 0x40));
  75   2        }
  76   1      }
  77          
  78          /**
  79           * @brief  LCD1602åˆå§‹åŒ–å‡½æ•°
  80           * @param  æ— 
  81           * @retval æ— 
  82           */
  83          void LCD_Init()
  84          {
  85   1        LCD_WriteCommand(0x38); // å…«ä½æ•°æ®æ¥å£ï¼Œä¸¤è¡Œæ˜¾ç¤ºï¼Œ5*7ç‚¹é˜µ
  86   1        LCD_WriteCommand(0x0c); // æ˜¾ç¤ºå¼€ï¼Œå…‰æ ‡å…³ï¼Œé—ªçƒå…³
  87   1        LCD_WriteCommand(0x06); // æ•°æ®è¯»å†™æ“ä½œåï¼Œå…‰æ ‡è‡ªåŠ¨åŠ ä¸€ï¼Œç”»é¢ä¸åŠ¨
  88   1        LCD_WriteCommand(0x01); // å…‰æ ‡å¤ä½ï¼Œæ¸…å±
  89   1      }
  90          
  91          /**
  92           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®ä¸Šæ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦
  93           * @param  Line è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
  94           * @param  Column åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
  95           * @param  Char è¦æ˜¾ç¤ºçš„å­—ç¬¦
  96           * @retval æ— 
  97           */
  98          void LCD_ShowChar(unsigned char Line, unsigned char Column, char Char)
  99          {
 100   1        LCD_SetCursor(Line, Column);
 101   1        LCD_WriteData(Char);
 102   1      }
 103          
 104          /**
 105           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®å¼€å§‹æ˜¾ç¤ºæ‰€ç»™å­—ç¬¦ä¸²
 106           * @param  Line èµ·å§‹è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
 107           * @param  Column èµ·å§‹åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
 108           * @param  String è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²
 109           * @retval æ— 
 110           */
 111          void LCD_ShowString(unsigned char Line, unsigned char Column, char *String)
 112          {
 113   1        unsigned char i;
 114   1        LCD_SetCursor(Line, Column);
 115   1        for (i = 0; String[i] != '\0'; i++)
 116   1        {
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 3   

 117   2          LCD_WriteData(String[i]);
 118   2        }
 119   1      }
 120          
 121          /**
 122           * @brief  è¿”å›å€¼=Xçš„Yæ¬¡æ–¹
 123           */
 124          int LCD_Pow(int X, int Y)
 125          {
 126   1        unsigned char i;
 127   1        int Result = 1;
 128   1        for (i = 0; i < Y; i++)
 129   1        {
 130   2          Result *= X;
 131   2        }
 132   1        return Result;
 133   1      }
 134          
 135          /**
 136           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®å¼€å§‹æ˜¾ç¤ºæ‰€ç»™æ•°å­—
 137           * @param  Line èµ·å§‹è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
 138           * @param  Column èµ·å§‹åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
 139           * @param  Number è¦æ˜¾ç¤ºçš„æ•°å­—ï¼ŒèŒƒå›´ï¼š0~65535
 140           * @param  Length è¦æ˜¾ç¤ºæ•°å­—çš„é•¿åº¦ï¼ŒèŒƒå›´ï¼š1~5
 141           * @retval æ— 
 142           */
 143          void LCD_ShowNum(unsigned char Line, unsigned char Column, unsigned int Number, unsigned char Length)
 144          {
 145   1        unsigned char i;
 146   1        LCD_SetCursor(Line, Column);
 147   1        for (i = Length; i > 0; i--)
 148   1        {
 149   2          LCD_WriteData(Number / LCD_Pow(10, i - 1) % 10 + '0');
 150   2        }
 151   1      }
 152          
 153          /**
 154           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®å¼€å§‹ä»¥æœ‰ç¬¦å·åè¿›åˆ¶æ˜¾ç¤ºæ‰€ç»™æ•°å­—
 155           * @param  Line èµ·å§‹è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
 156           * @param  Column èµ·å§‹åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
 157           * @param  Number è¦æ˜¾ç¤ºçš„æ•°å­—ï¼ŒèŒƒå›´ï¼š-32768~32767
 158           * @param  Length è¦æ˜¾ç¤ºæ•°å­—çš„é•¿åº¦ï¼ŒèŒƒå›´ï¼š1~5
 159           * @retval æ— 
 160           */
 161          void LCD_ShowSignedNum(unsigned char Line, unsigned char Column, int Number, unsigned char Length)
 162          {
 163   1        unsigned char i;
 164   1        unsigned int Number1;
 165   1        LCD_SetCursor(Line, Column);
 166   1        if (Number >= 0)
 167   1        {
 168   2          LCD_WriteData('+');
 169   2          Number1 = Number;
 170   2        }
 171   1        else
 172   1        {
 173   2          LCD_WriteData('-');
 174   2          Number1 = -Number;
 175   2        }
 176   1        for (i = Length; i > 0; i--)
 177   1        {
 178   2          LCD_WriteData(Number1 / LCD_Pow(10, i - 1) % 10 + '0');
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 4   

 179   2        }
 180   1      }
 181          
 182          /**
 183           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®å¼€å§‹ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºæ‰€ç»™æ•°å­—
 184           * @param  Line èµ·å§‹è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
 185           * @param  Column èµ·å§‹åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
 186           * @param  Number è¦æ˜¾ç¤ºçš„æ•°å­—ï¼ŒèŒƒå›´ï¼š0~0xFFFF
 187           * @param  Length è¦æ˜¾ç¤ºæ•°å­—çš„é•¿åº¦ï¼ŒèŒƒå›´ï¼š1~4
 188           * @retval æ— 
 189           */
 190          void LCD_ShowHexNum(unsigned char Line, unsigned char Column, unsigned int Number, unsigned char Length)
 191          {
 192   1        unsigned char i, SingleNumber;
 193   1        LCD_SetCursor(Line, Column);
 194   1        for (i = Length; i > 0; i--)
 195   1        {
 196   2          SingleNumber = Number / LCD_Pow(16, i - 1) % 16;
 197   2          if (SingleNumber < 10)
 198   2          {
 199   3            LCD_WriteData(SingleNumber + '0');
 200   3          }
 201   2          else
 202   2          {
 203   3            LCD_WriteData(SingleNumber - 10 + 'A');
 204   3          }
 205   2        }
 206   1      }
 207          
 208          /**
 209           * @brief  åœ¨LCD1602æŒ‡å®šä½ç½®å¼€å§‹ä»¥äºŒè¿›åˆ¶æ˜¾ç¤ºæ‰€ç»™æ•°å­—
 210           * @param  Line èµ·å§‹è¡Œä½ç½®ï¼ŒèŒƒå›´ï¼š1~2
 211           * @param  Column èµ·å§‹åˆ—ä½ç½®ï¼ŒèŒƒå›´ï¼š1~16
 212           * @param  Number è¦æ˜¾ç¤ºçš„æ•°å­—ï¼ŒèŒƒå›´ï¼š0~1111 1111 1111 1111
 213           * @param  Length è¦æ˜¾ç¤ºæ•°å­—çš„é•¿åº¦ï¼ŒèŒƒå›´ï¼š1~16
 214           * @retval æ— 
 215           */
 216          void LCD_ShowBinNum(unsigned char Line, unsigned char Column, unsigned int Number, unsigned char Length)
 217          {
 218   1        unsigned char i;
 219   1        LCD_SetCursor(Line, Column);
 220   1        for (i = Length; i > 0; i--)
 221   1        {
 222   2          LCD_WriteData(Number / LCD_Pow(2, i - 1) % 2 + '0');
 223   2        }
 224   1      }
 225          
 226          void Delay(unsigned int xms) //@12MHz
 227          {
 228   1        unsigned char data i, j;
 229   1      
 230   1        while (xms--)
 231   1        {
 232   2          i = 2;
 233   2          j = 239;
 234   2          do
 235   2          {
 236   3            while (--j)
 237   3              ;
 238   3          } while (--i);
 239   2        }
 240   1      }
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 5   

 241          
 242          void NixieTube(unsigned char Location, unsigned char Number)
 243          {
 244   1        unsigned char NixieTable[] = {0x3F, 0x06, 0x5B, 0x4F, 0x66, 0x6D, 0x7D, 0x07, 0x7F, 0x6F};
 245   1        switch (Location)
 246   1        {
 247   2        case 1:
 248   2          P2_4 = 1;
 249   2          P2_3 = 1;
 250   2          P2_2 = 1;
 251   2          break;
 252   2        case 2:
 253   2          P2_4 = 1;
 254   2          P2_3 = 1;
 255   2          P2_2 = 0;
 256   2          break;
 257   2        case 3:
 258   2          P2_4 = 1;
 259   2          P2_3 = 0;
 260   2          P2_2 = 1;
 261   2          break;
 262   2        case 4:
 263   2          P2_4 = 1;
 264   2          P2_3 = 0;
 265   2          P2_2 = 0;
 266   2          break;
 267   2        case 5:
 268   2          P2_4 = 0;
 269   2          P2_3 = 1;
 270   2          P2_2 = 1;
 271   2          break;
 272   2        case 6:
 273   2          P2_4 = 0;
 274   2          P2_3 = 1;
 275   2          P2_2 = 0;
 276   2          break;
 277   2        case 7:
 278   2          P2_4 = 0;
 279   2          P2_3 = 0;
 280   2          P2_2 = 1;
 281   2          break;
 282   2        case 8:
 283   2          P2_4 = 0;
 284   2          P2_3 = 0;
 285   2          P2_2 = 0;
 286   2          break;
 287   2        }
 288   1        P0 = NixieTable[Number];
 289   1        Delay(1);
 290   1        P0 = 0x00;
 291   1      }
 292          
 293          // ä½œç”¨æ˜¯è·å–çŸ©é˜µé”®ç›˜ï¼ŒèŒƒå›´ä¸º0~16ï¼Œæ— æŒ‰é”®æŒ‰ä¸‹è¿”å›å€¼ä¸º0
 294          unsigned char MatrixKeyboard()
 295          {
 296   1        unsigned char KeyNumber = 0;
 297   1      
 298   1        P1 = 0xFF;
 299   1        P1_3 = 0; /*ç»“åˆç”µè·¯åŸç†å›¾ï¼Œå½“P1_3=0ï¼Œå…¶ä»–åˆ—ä¸º1æ—¶ï¼Œåˆ™æ£€æµ‹ç¬¬1åˆ—ï¼Œå½“æœ‰æŒ‰é”®æŒ‰ä¸‹æ
             -—¶ï¼Œ
 300   1                 æ¯”å¦‚S1è¢«æŒ‰ä¸‹ï¼Œé‚£ä¹ˆç”µè·¯å¯¼é€šï¼Œä¼šä½¿å¾—P1_7=0;åä¹‹ï¼Œè‹¥P1_7=0,åˆ™S1è¢«æŒ‰ä¸‹ï¼Œ
 301   1                 æ‰€ä»¥æˆ‘ä»¬ä¾æ¬¡åˆ¤æ–­å¯¹åº”4ä¸ªIOå£æ˜¯å¦ä¸º0å°±å¯ä»¥çŸ¥é“å“ªä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹äº†ï¼Œ
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 6   

 302   1                 ç„¶åä¾æ¬¡åˆ‡æ¢å¯¹åº”åˆ—ï¼Œé€ä¸ªæ‰«æå°±èƒ½è¯†åˆ«æ•´ä¸ªçŸ©é˜µé”®ç›˜å“ªä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹äº†ã€‚
             -*/
 303   1        if (P1_7 == 0)
 304   1        {
 305   2          Delay(100);
 306   2          while (P1_7 == 0)
 307   2            ;
 308   2          Delay(100);
 309   2          KeyNumber = 1;
 310   2        }
 311   1        if (P1_6 == 0)
 312   1        {
 313   2          Delay(100);
 314   2          while (P1_7 == 0)
 315   2            ;
 316   2          Delay(100);
 317   2          KeyNumber = 5;
 318   2        }
 319   1        if (P1_5 == 0)
 320   1        {
 321   2          Delay(100);
 322   2          while (P1_7 == 0)
 323   2            ;
 324   2          Delay(100);
 325   2          KeyNumber = 9;
 326   2        }
 327   1        if (P1_4 == 0)
 328   1        {
 329   2          Delay(100);
 330   2          while (P1_7 == 0)
 331   2            ;
 332   2          Delay(100);
 333   2          KeyNumber = 13;
 334   2        }
 335   1      
 336   1        P1 = 0xFF;
 337   1        P1_2 = 0;
 338   1        if (P1_7 == 0)
 339   1        {
 340   2          Delay(100);
 341   2          while (P1_7 == 0)
 342   2            ;
 343   2          Delay(100);
 344   2          KeyNumber = 2;
 345   2        }
 346   1        if (P1_6 == 0)
 347   1        {
 348   2          Delay(100);
 349   2          while (P1_7 == 0)
 350   2            ;
 351   2          Delay(100);
 352   2          KeyNumber = 6;
 353   2        }
 354   1        if (P1_5 == 0)
 355   1        {
 356   2          Delay(100);
 357   2          while (P1_7 == 0)
 358   2            ;
 359   2          Delay(100);
 360   2          KeyNumber = 10;
 361   2        }
 362   1        if (P1_4 == 0)
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 7   

 363   1        {
 364   2          Delay(100);
 365   2          while (P1_7 == 0)
 366   2            ;
 367   2          Delay(100);
 368   2          KeyNumber = 14;
 369   2        }
 370   1      
 371   1        P1 = 0xFF;
 372   1        P1_1 = 0;
 373   1        if (P1_7 == 0)
 374   1        {
 375   2          Delay(100);
 376   2          while (P1_7 == 0)
 377   2            ;
 378   2          Delay(100);
 379   2          KeyNumber = 3;
 380   2        }
 381   1        if (P1_6 == 0)
 382   1        {
 383   2          Delay(100);
 384   2          while (P1_7 == 0)
 385   2            ;
 386   2          Delay(100);
 387   2          KeyNumber = 7;
 388   2        }
 389   1        if (P1_5 == 0)
 390   1        {
 391   2          Delay(100);
 392   2          while (P1_7 == 0)
 393   2            ;
 394   2          Delay(100);
 395   2          KeyNumber = 11;
 396   2        }
 397   1        if (P1_4 == 0)
 398   1        {
 399   2          Delay(100);
 400   2          while (P1_7 == 0)
 401   2            ;
 402   2          Delay(100);
 403   2          KeyNumber = 15;
 404   2        }
 405   1      
 406   1        P1 = 0xFF;
 407   1        P1_0 = 0;
 408   1        if (P1_7 == 0)
 409   1        {
 410   2          Delay(100);
 411   2          while (P1_7 == 0)
 412   2            ;
 413   2          Delay(100);
 414   2          KeyNumber = 4;
 415   2        }
 416   1        if (P1_6 == 0)
 417   1        {
 418   2          Delay(100);
 419   2          while (P1_7 == 0)
 420   2            ;
 421   2          Delay(100);
 422   2          KeyNumber = 8;
 423   2        }
 424   1        if (P1_5 == 0)
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 8   

 425   1        {
 426   2          Delay(100);
 427   2          while (P1_7 == 0)
 428   2            ;
 429   2          Delay(100);
 430   2          KeyNumber = 12;
 431   2        }
 432   1        if (P1_4 == 0)
 433   1        {
 434   2          Delay(100);
 435   2          while (P1_7 == 0)
 436   2            ;
 437   2          Delay(100);
 438   2          KeyNumber = 16;
 439   2        }
 440   1      
 441   1        return KeyNumber;
 442   1      }
 443          
 444          void Timer0Init() // 1ms@12MHz
 445          {
 446   1        TMOD &= 0xF0; // æŠŠTMODçš„ä½å››ä½æ¸…é›¶ï¼Œé«˜å››ä½ä¿æŒä¸å˜
 447   1        TMOD |= 0x01; // æŠŠTMODçš„æœ€ä½ä½ç½®1ï¼Œå…¶ä»–7ä½ä¿æŒä¸å˜ï¼Œè¿™é‡Œå³è®¾ç½®äº†å®šæ—¶å™¨0çš„æ¨¡å¼
             -æ˜¯å·¥ä½œæ–¹å¼1ï¼š16ä¸ºè®¡æ•°å™¨
 448   1        // è¿™æ ·åšçš„å¥½å¤„å°±åœ¨äºå¯ä»¥åªæ“ä½œTMODçš„å…¶ä¸­æŸäº›ä½è€Œä¸å½±å“å…¶ä»–ä½
 449   1      
 450   1        TF0 = 0; // è®¾ç½®T0å®šæ—¶å™¨æº¢å‡ºæ ‡å¿—ä½ä¸º0
 451   1        TR0 = 1; // å³å¯åŠ¨å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
 452   1      
 453   1        TH0 = 0xFC; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ä¸º64535+1
 454   1        TL0 = 0x18;
 455   1        // å¦ä¸€å†™æ³•
 456   1        //  TH0=64535/256;//ä½œç”¨å³å¾—åˆ°64535è½¬16è¿›åˆ¶åçš„é«˜8ä½ï¼Œè¿™é‡Œé™¤çš„ç»“æœåªå–æ•´æ•°ï¼Œä¸å–
             -å°æ•°
 457   1        //                ï¼ˆç»“æœå³åè¿›åˆ¶çš„252ï¼Œè½¬16è¿›åˆ¶å°±æ˜¯FCï¼Œåˆšå¥½å°±æ˜¯64535çš„åå…­è¿›åˆ¶é«˜8ä½ï¼‰
 458   1        //  TL0=64535%256+1;//ç»“æœå³64535è½¬16è¿›åˆ¶åçš„ä½8ä½ï¼ˆåŒç†ï¼Œè‡ªå·±è®¡ç®—ï¼‰ï¼Œ+1æ˜¯å› ä¸ºå®šæ—
             -¶å™¨
 459   1        // æœ€å¤§å®šæ—¶ä¸º65535ï¼Œè€Œå®šæ—¶å™¨è¦åˆ°65536æ‰æº¢å‡ºï¼Œæ‰€ä»¥64535åˆ°65536æ˜¯1001ï¼Œå¤šäº†1å¾®ç§’ï¼
             -Œè¿™æ ·å®šæ—¶å°±æ˜¯1.001ms
 460   1      
 461   1        ET0 = 1; // T0å¯¹åº”çš„ä¸­æ–­å¼€å…³é—­åˆ
 462   1        EA = 1;  // ä¸­æ–­æ€»å¼€å…³é—­åˆ
 463   1        PT0 = 0; // è®¾ç½®ä¸­æ–­ä¼˜å…ˆçº§ä¸ºä½çº§
 464   1      }
 465          
 466          /*ä¸Šé¢çš„çš„å®šæ—¶å™¨åˆå§‹åŒ–ç¨‹åºè¦é…åˆä¸‹é¢çš„å®šæ—¶å™¨ä¸­æ–­ç¨‹åºæ¨¡æ¿ï¼Œåªä¸è¿‡ä¸­æ–­ç¨‹åº
             -è¦å†™åˆ°ä¸»å‡½æ•°æ–‡ä»¶ä¸ä¸»å‡½æ•°é…åˆ
 467          void Timer0_Routine() interrupt 1 //å®šæ—¶å™¨T0çš„ä¸­æ–­ç¨‹åºå‡½æ•°å‘½åéšæ„ï¼Œinterrupt 1ç”¨äºå°†æ­¤
             -å‡½æ•°å®šä¹‰ä¸ºå®šæ—¶å™¨0çš„ä¸­æ–­ç¨‹åº
 468          {
 469            static unsigned int T0Count;//é™æ€å˜é‡ä½¿å¾—è¯¥å˜é‡å‡ºäº†æ­¤å‡½æ•°ä»ç„¶ä¸ä¼šè¢«é”€æ¯
 470            TH0=0xFC;//æ¯æ¬¡è®¡æ—¶è®¡å®Œåéœ€è¦é‡æ–°èµ‹åˆå€¼ï¼Œè‹¥
 471            TL0=0x18;//ä¸èµ‹åˆå€¼ï¼Œå®ƒä¼šé»˜è®¤é‡0å¼€å§‹è®¡æ—¶
 472            T0Count++;
 473            if(T0Count>=1000)
 474            {
 475              T0Count=0;
 476          
 477            }
 478          }
 479          */
 480          
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 9   

 481          // ä½œç”¨æ˜¯è·å–ç‹¬ç«‹æŒ‰é”®ï¼ŒèŒƒå›´ä¸º0~4ï¼Œæ— æŒ‰é”®æŒ‰ä¸‹è¿”å›å€¼ä¸º0
 482          unsigned char IndependentKey()
 483          {
 484   1        unsigned char KeyNumber = 0;
 485   1      
 486   1        if (P3_1 == 0)
 487   1        {
 488   2          Delay(100);
 489   2          while (P3_1 == 0)
 490   2            ;
 491   2          Delay(100);
 492   2          KeyNumber = 1;
 493   2        }
 494   1        if (P3_0 == 0)
 495   1        {
 496   2          Delay(100);
 497   2          while (P3_0 == 0)
 498   2            ;
 499   2          Delay(100);
 500   2          KeyNumber = 2;
 501   2        }
 502   1        if (P3_2 == 0)
 503   1        {
 504   2          Delay(100);
 505   2          while (P3_2 == 0)
 506   2            ;
 507   2          Delay(100);
 508   2          KeyNumber = 3;
 509   2        }
 510   1        if (P3_3 == 0)
 511   1        {
 512   2          Delay(100);
 513   2          while (P3_3 == 0)
 514   2            ;
 515   2          Delay(100);
 516   2          KeyNumber = 4;
 517   2        }
 518   1      
 519   1        return KeyNumber;
 520   1      }
 521          
 522          void UART_Init() // æ³¢ç‰¹ç‡4800
 523          {
 524   1        SCON = 0x50;  // å…¶ä»–åˆå§‹åŒ–ä¸º0ï¼Œè€Œé€‰æ‹©å·¥ä½œæ–¹å¼ä¸º1ä¸”RENç½®ä¸º1å…è®¸ä¸²å£æ¥å—æ•°æ®
 525   1        PCON |= 0x80; // ä½¿èƒ½æ³¢ç‰¹ç‡åŠ å€ï¼Œä»è€Œå‡å°‘è¯¯å·®
 526   1        // æ³¨æ„51çš„ä¸²å£åªèƒ½é…ç½®å®šæ—¶å™¨1
 527   1        TMOD &= 0x0F;
 528   1        TMOD |= 0x20; // ä¸²å£éœ€è¦å®šæ—¶å™¨1è®¾ç½®ä¸º8ä½è‡ªåŠ¨é‡è£…æ¨¡å¼
 529   1        // 8ä½è‡ªåŠ¨é‡è£…æ¨¡å¼å°±æ˜¯åªèµ‹ä¸€æ¬¡åˆå€¼ï¼Œåé¢è‡ªåŠ¨è£…è½½ï¼Œè€Œæ— éœ€å†ä¸­æ–­ç¨‹åºä¸­å†è£
             -…åˆå€¼
 530   1      
 531   1        // è¿™é‡Œæ— éœ€è®¾ç½®æº¢å‡ºæ ‡å¿—ä½ï¼Œå› ä¸ºåªè¦å®šæ—¶å™¨1åœ¨è®¡æ•°æœ‰æº¢å‡ºå°±ä¼šç”Ÿæˆæ³¢ç‰¹ç‡
 532   1        TR1 = 1; // å³å¯åŠ¨å®šæ—¶å™¨1å¼€å§‹è®¡æ—¶
 533   1      
 534   1        TH1 = 0xF4; // è®¾ç½®å®šæ—¶å™¨1åˆå€¼
 535   1        TL1 = 0xF4; // è®¾ç½®å®šæ—¶å™¨1çš„è‡ªåŠ¨é‡è½½å€¼
 536   1      
 537   1        ET1 = 0; // ç¦æ­¢å®šæ—¶å™¨ä¸­æ–­,è¿™é‡Œä¸éœ€è¦å®šæ—¶å™¨ä¸­æ–­
 538   1      
 539   1        EA = 1;//æ€»ä¸­æ–­å¼€å…³é—­åˆ
 540   1        ES = 1;//ä¸²å£ä¸­æ–­å¼€å…³é—­åˆï¼Œå½“å‘é€/æ¥å—æ•°æ®æ—¶ï¼Œåˆ™è§¦å‘ä¸­æ–­
 541   1      }
C51 COMPILER V9.59.0.0   DALYA                                                             11/15/2024 22:57:30 PAGE 10  

 542          
 543          void UART_SendByte(unsigned char Byte)
 544          {
 545   1        SBUF = Byte;  // SBUFè´Ÿè´£æ¥æ”¶/å‘é€æ•°æ®
 546   1        while (TI == 0) // TIæ˜¯å‘é€æ§åˆ¶å™¨ï¼Œå½“å‘é€å®ŒæˆåTI=0ï¼Œå¦åˆ™ä¸º1ï¼Œ
 547   1        {       // è¿™é‡Œä¸å¯ä»¥ä¸€ç›´å‘é€ï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“TIå‘é€å®Œååæ‰èƒ½ç»§ç»­å‘é€
 548   2          ;
 549   2        }
 550   1        TI = 0; // TIä¸èƒ½è‡ªåŠ¨å¤ä½ï¼Œéœ€ç¨‹åºå¤ä½ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡çš„åˆ¤æ–­
 551   1      }
 552          
 553          /*ä¸­æ–­ç¨‹åºè¦å†™åˆ°ä¸»å‡½æ•°æ–‡ä»¶ä¸ä¸»å‡½æ•°é…åˆ,è¿™é‡Œçš„ä¸²å£ä¸­æ–­ç¨‹åºæ˜¯ç”¨äºç”µè„‘å‘é€ç
             -»™å•ç‰‡æœºæ•°æ®ï¼Œå•ç‰‡æœºåˆ™è§¦å‘ä¸­æ–­æ¥æ¥å—æ•°æ®
 554          void UART_Routine() interrupt 4 // interrupt 4ç”¨äºå°†æ­¤å‡½æ•°å®šä¹‰ä¸ºä¸²å£ä¸­æ–­çš„ç¨‹åº
 555          {
 556            if (RI == 1) // æ¥å—ä¸­æ–­è¯·æ±‚æ ‡å¿—ä½ï¼Œ1å³æ¥å—ï¼Œå› ä¸ºå‘é€å’Œæ¥å—ä¸­æ–­æ ‡å¿—ä½æ˜¯ç”¨çš„å
             -Œä¸€ä¸ªæˆ–é—¨ï¼Œ
 557            {      // æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ç©¶ç«Ÿæ˜¯å‘é€è¿˜æ˜¯æ¥å—è§¦å‘çš„ä¸­æ–­
 558              ;
 559              RI = 0; // RIä¸èƒ½è‡ªåŠ¨å¤ä½ï¼Œéœ€ç¨‹åºå¤ä½ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡çš„åˆ¤æ–­
 560            }
 561          }
 562          */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    978    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      41
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
